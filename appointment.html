<!-- Replace the existing form section with this updated version -->
<form id="appointment-form" class="appointment-form">
  <div class="form-group animate__animated animate__fadeIn animate-delay-1">
    <input type="text" name="user_name" placeholder="Full Name*" required>
  </div>
  <div class="form-group animate__animated animate__fadeIn animate-delay-1">
    <input type="email" name="user_email" placeholder="Email Address*" required>
  </div>
  <div class="form-group animate__animated animate__fadeIn animate-delay-1">
    <input type="tel" name="user_phone" placeholder="Phone Number*" required>
  </div>
  <div class="form-group animate__animated animate__fadeIn animate-delay-2">
    <select name="service_type" required>
      <option value="">Select Service*</option>
      <option value="Business Consulting">Business Consulting</option>
      <option value="Tax Solutions">Tax Solutions</option>
      <option value="Financial Advisory">Financial Advisory</option>
      <option value="Startup Services">Startup Services</option>
      <option value="Other">Other</option>
    </select>
  </div>
  <div class="form-row">
    <div class="form-group animate__animated animate__fadeIn animate-delay-2">
      <input type="text" id="appointment_date" name="appointment_date" placeholder="Select Date*" required readonly>
      <div id="datepicker" class="datepicker-container"></div>
    </div>
    <div class="form-group animate__animated animate__fadeIn animate-delay-2">
      <select id="appointment_time" name="appointment_time" required disabled>
        <option value="">Select Time*</option>
        <!-- Time slots will be populated by JavaScript -->
      </select>
    </div>
  </div>
  <div class="form-group animate__animated animate__fadeIn animate-delay-2">
    <textarea name="message" rows="5" placeholder="Tell us about your specific needs..."></textarea>
  </div>
  <button type="submit" class="btn btn-primary animate__animated animate__fadeIn animate-delay-2" style="width: 100%; padding: 16px;">
    Request Appointment
  </button>
</form>

<!-- Add this new CSS to your style section -->
<style>
  .datepicker-container {
    display: none;
    position: absolute;
    z-index: 1000;
    background: white;
    border: 1px solid #ddd;
    border-radius: 4px;
    box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    padding: 10px;
    margin-top: 5px;
  }
  
  .datepicker-container.active {
    display: block;
  }
  
  .datepicker-header {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 10px;
  }
  
  .datepicker-nav {
    background: none;
    border: none;
    font-size: 16px;
    cursor: pointer;
    padding: 5px 10px;
    color: var(--primary-color);
  }
  
  .datepicker-title {
    font-weight: 600;
  }
  
  .datepicker-grid {
    display: grid;
    grid-template-columns: repeat(7, 1fr);
    gap: 5px;
  }
  
  .datepicker-day-header {
    text-align: center;
    font-weight: 600;
    font-size: 12px;
    padding: 5px;
    color: var(--primary-color);
  }
  
  .datepicker-day {
    text-align: center;
    padding: 8px 5px;
    cursor: pointer;
    border-radius: 3px;
  transition: var(--transition);
  }
  
  .datepicker-day:hover {
    background-color: var(--primary-color);
    color: white;
  }
  
  .datepicker-day.disabled {
    color: #ccc;
    cursor: not-allowed;
    background: #f5f5f5;
  }
  
  .datepicker-day.selected {
    background-color: var(--primary-color);
    color: white;
  }
  
  #appointment_time:disabled {
    background-color: #f0f0f0;
    color: #999;
  }
</style>

<!-- Update the JavaScript section with this new code -->
<script>
  document.addEventListener('DOMContentLoaded', function() {
    // ... (keep all existing code above this)
    
    // Enhanced Date and Time Picker
    const dateInput = document.getElementById('appointment_date');
    const datepicker = document.getElementById('datepicker');
    const timeSelect = document.getElementById('appointment_time');
    
    if (dateInput && datepicker && timeSelect) {
      // Show datepicker when clicking date input
      dateInput.addEventListener('click', function() {
        datepicker.classList.toggle('active');
        renderDatepicker(new Date());
      });
      
      // Close datepicker when clicking outside
      document.addEventListener('click', function(e) {
        if (!dateInput.contains(e.target) && !datepicker.contains(e.target)) {
          datepicker.classList.remove('active');
        }
      });
      
      // Generate time slots for a given date
      function generateTimeSlots(selectedDate) {
        timeSelect.innerHTML = '<option value="">Select Time*</option>';
        timeSelect.disabled = true;
        
        const day = selectedDate.getDay(); // 0 = Sunday, 6 = Saturday
        if (day === 0) return; // Sunday - closed
        
        // Determine working hours
        let startHour = 9; // 9 AM
        let endHour = day === 6 ? 15 : 18; // 3 PM on Saturday, 6 PM otherwise
        
        // Generate time slots (1 hour each)
        for (let hour = startHour; hour < endHour; hour++) {
          const timeString = `${hour.toString().padStart(2, '0')}:00 - ${(hour + 1).toString().padStart(2, '0')}:00`;
          const timeValue = `${hour.toString().padStart(2, '0')}:00`;
          
          const option = document.createElement('option');
          option.value = timeValue;
          option.textContent = timeString;
          timeSelect.appendChild(option);
        }
        
        timeSelect.disabled = false;
      }
      
      // Render the datepicker
      function renderDatepicker(date) {
        const year = date.getFullYear();
        const month = date.getMonth();
        
        // Get first day of month and total days
        const firstDay = new Date(year, month, 1).getDay();
        const daysInMonth = new Date(year, month + 1, 0).getDate();
        
        // Get today's date
        const today = new Date();
        today.setHours(0, 0, 0, 0);
        
        // Create datepicker header
        const monthNames = ["January", "February", "March", "April", "May", "June",
                          "July", "August", "September", "October", "November", "December"];
        
        datepicker.innerHTML = `
          <div class="datepicker-header">
            <button class="datepicker-nav prev-month">&lt;</button>
            <div class="datepicker-title">${monthNames[month]} ${year}</div>
            <button class="datepicker-nav next-month">&gt;</button>
          </div>
          <div class="datepicker-grid">
            <div class="datepicker-day-header">Sun</div>
            <div class="datepicker-day-header">Mon</div>
            <div class="datepicker-day-header">Tue</div>
            <div class="datepicker-day-header">Wed</div>
            <div class="datepicker-day-header">Thu</div>
            <div class="datepicker-day-header">Fri</div>
            <div class="datepicker-day-header">Sat</div>
          </div>
        `;
        
        // Add day cells
        const grid = datepicker.querySelector('.datepicker-grid');
        
        // Add empty cells for days before the first day of month
        for (let i = 0; i < firstDay; i++) {
          const emptyCell = document.createElement('div');
          emptyCell.className = 'datepicker-day disabled';
          grid.appendChild(emptyCell);
        }
        
        // Add day cells
        for (let day = 1; day <= daysInMonth; day++) {
          const dayCell = document.createElement('div');
          dayCell.className = 'datepicker-day';
          dayCell.textContent = day;
          
          const currentDate = new Date(year, month, day);
          const isPastDate = currentDate < today;
          const isSunday = currentDate.getDay() === 0;
          
          if (isPastDate || isSunday) {
            dayCell.classList.add('disabled');
          } else {
            dayCell.addEventListener('click', function() {
              // Update selected date
              const selectedDate = new Date(year, month, day);
              dateInput.value = selectedDate.toLocaleDateString('en-US', { 
                weekday: 'short', 
                year: 'numeric', 
                month: 'short', 
                day: 'numeric' 
              });
              
              // Store ISO format in a data attribute for form submission
              dateInput.dataset.isoValue = selectedDate.toISOString().split('T')[0];
              
              // Update time slots
              generateTimeSlots(selectedDate);
              
              // Close datepicker
              datepicker.classList.remove('active');
              
              // Highlight selected day
              datepicker.querySelectorAll('.datepicker-day').forEach(cell => {
                cell.classList.remove('selected');
              });
              this.classList.add('selected');
            });
          }
          
          grid.appendChild(dayCell);
        }
        
        // Add navigation events
        datepicker.querySelector('.prev-month').addEventListener('click', function(e) {
          e.stopPropagation();
          renderDatepicker(new Date(year, month - 1, 1));
        });
        
        datepicker.querySelector('.next-month').addEventListener('click', function(e) {
          e.stopPropagation();
          renderDatepicker(new Date(year, month + 1, 1));
        });
      }
      
      // Update form submission to use the ISO date format
      appointmentForm.addEventListener('submit', function(event) {
        if (dateInput.dataset.isoValue) {
          // Create a hidden input with the ISO date format
          const hiddenDateInput = document.createElement('input');
          hiddenDateInput.type = 'hidden';
          hiddenDateInput.name = 'appointment_date_iso';
          hiddenDateInput.value = dateInput.dataset.isoValue;
          this.appendChild(hiddenDateInput);
        }
        
        // Rest of your existing form submission code...
      });
    }
    
    // ... (keep all existing code below this)
  });
</script>
